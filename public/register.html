<!DOCTYPE html>
<html>
<head>
  <title>Register - QuickBite</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h2>Register</h2>
  <form onsubmit="register(event)">
    <p><input type="text" id="name" placeholder="Full Name" required></p>
    <p><input type="email" id="email" placeholder="Email" required></p>
    <p><input type="password" id="password" placeholder="Password" required></p>
    <p><input type="text" id="phone" placeholder="Phone" required></p>
    <p><input type="text" id="address" placeholder="Address" required></p>
    <p>
      <select id="role" onchange="toggleRestaurant()" required>
        <option value="">-- Select Role --</option>
        <option value="customer">Customer</option>
        <option value="restaurant">Restaurant</option>
      </select>
    </p>

    <div id="restaurantField" style="display:none;">
      <p><input type="text" id="restaurant_name" placeholder="Restaurant Name"></p>
    </div>

    <p><button type="submit">Register</button></p>
  </form>

  <p>Already have an account? <a href="login.html">Login here</a></p>

  <script>
    function toggleRestaurant() {
      const role = document.getElementById("role").value;
      document.getElementById("restaurantField").style.display =
        role === "restaurant" ? "block" : "none";
    }

    async function register(event) {
      event.preventDefault();

      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      const phone = document.getElementById("phone").value;
      const address = document.getElementById("address").value;
      const role = document.getElementById("role").value;
      const restaurant_name = document.getElementById("restaurant_name").value;

      const res = await fetch("/api/auth/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email, password, phone, address, role, restaurant_name })
      });

      const data = await res.json();

      if (res.ok) {
        alert("Registration successful! Please login.");
        window.location.href = "login.html";
      } else {
        alert(data.message);
      }
    }
  </script>
</body>
</html>
